var{SHOW_DOCUMENT_FRAGMENT:$,SHOW_ELEMENT:U,SHOW_TEXT:X}=NodeFilter,I=["PRE","TEXTAREA"],E=new WeakMap,K=t=>t.trim().replace(/(>)(\s+)|(\s+)(<\/)/g,"$1$4");function V(t,e={}){let n=document.createElement("div");n.innerHTML=t;let s=document.createDocumentFragment();for(;n.hasChildNodes();)s.appendChild(n.firstChild);let r=document.createTreeWalker(s,$|U|X,null,!1),i={tag:"div",attrs:{},children:[],context:e};for(;r.nextNode();){let o=r.currentNode,a=E.get(o.parentNode),c;if(o.nodeType===Node.TEXT_NODE)c=e.trim&&!I.includes(o.parentNode?.tagName)?K(o.textContent??""):o.textContent;else{c={tag:o.tagName,...G(o),children:[],context:e};for(let l in c.events){let d=new Function("event","context",`with (context) { ${c.events[l]} }`);c.events[l]=function(h){return d.call(this,h,c.context)}}}E.set(o,c),a?a.children.push(c):i.children.push(c)}return i}var G=t=>[...t.attributes].reduce((e,n)=>(e[["attrs","events"][+(n.name.indexOf("on")===0)]][n.name]=n.value,e),{attrs:{},events:{}}),Q=(t,e,n,s=e.updated)=>{if(!e.tag)return t.data!==e&&(n.updated=!0)&&(t.data=e);for(let r in e.events)t[r]=e.events[r],s=!0;for(let r in e.attrs)t.getAttribute(r)!==e.attrs[r]&&(s=!0)&&t.setAttribute(r,e.attrs[r]);for(let{name:r}of[...t.attributes])!(r in e.attrs)&&(s=!0)&&t.removeAttribute(r);return e.updated=s},O=t=>t.tag&&(t.rendered=!0)?document.createElement(t.tag):document.createTextNode(t);function v(t,e){let n=t.childNodes,s=e.children;for(;n.length>s.length;)t.removeChild(t.lastChild);for(let[r,i]of s.entries()){let o=n[r];o?o.tagName!==i.tag&&t.replaceChild(o=O(i),n[r]):t.appendChild(o=O(i)),Q(o,i,e),i.children&&v(o,i)}e.updated&&T(t,"onupdate"),e.rendered&&T(t,"onrender")}var T=(t,e,n=t.tagName&&t[e])=>n&&n.call(t);function R(t,e,n){v(t,V(e,n))}var u=window;u.__methods__??=new Map;u.__currentObject__??=null;var j=t=>(t?t+"_":"")+(Math.random()*1e7|0).toString(36),f=(t,e,n)=>{let s=j(n);return u.__methods__.set(s,e.bind(t)),e.toString=()=>`__methods__.get('${s}')`,e},A=(t,e)=>{for(let[n,s]of Object.entries(e))typeof s=="function"&&f(t,s,n);return e},M=t=>(e,...n)=>{let s="";for(let r=0;r<e.length;r++){s+=e[r];let i=n[r];typeof i=="function"?s+=f(t??u.__currentObject__,i).toString():i&&(s+=i)}return s},at=(t,e)=>{let n=j("x"),s=`<${t} id="${n}"></${t.split(" ")[0]}>`,r=u.__currentObject__;return p(()=>{let i=r.get("#"+n);i&&(i.textContent=e.value)},e),s};var m={array:Array,object:Object,string:String,number:Number,boolean:Boolean,function:Function},z=t=>Array.isArray(t)?m.array:m[typeof t],J=t=>t===Boolean?!1:t===Array?[]:t===Function?()=>{}:t===String?"":null,Y=(t,e)=>t===Boolean&&e===""?!0:t===Array?Array.isArray(e)?e.slice():[]:t===Function?typeof e=="function"?e:()=>{}:t(e),Z=new WeakMap,g=!1,x=!1,lt=t=>{let e=x;x=!0;try{t()}catch(n){console.error(n)}x=e},b=(t={})=>{let e={},n=new Map,s=new Map,r=new Set;for(let[o,a]of Object.entries(t))Object.values(m).includes(a)?(n.set(o,a),e[o]=J(a)):(n.set(o,z(a)),e[o]=a,r.add(o)),s.set(o,new Set);let i=new Proxy(e,{get(o,a,c){return g?Reflect.get(o,a):{name:a,proxy:c,subscribe(l){s.get(a).add(l)},unsubscribe(l){s.get(a).delete(l)},get hasResolved(){return r.has(a)},get value(){return this.valueOf()},[Symbol.toPrimitive](){return this.valueOf()},valueOf(){return Reflect.get(o,a)}}},set(o,a,c){let l=n.get(a);if(!l)throw new ReferenceError("State has no property: "+a.toString());let d=Y(l,c);if(d===Reflect.get(o,a))return!0;let h=Reflect.set(o,a,d);return h&&(r.add(a),s.get(a).forEach(B=>N(B,a))),h},ownKeys(o){return Reflect.ownKeys(o)}});return Z.set(i,{target:e,props:s,types:n,resolved:r}),i},P=t=>e=>{let n=g;g=t;try{e()}catch(s){console.error(s)}g=n},k=P(!0),y=P(!1),_=new WeakMap,w=new WeakSet,N=(t,e)=>{let n=[..._.get(t)];n.every(r=>r.hasResolved)&&(u.__currentObject__=q.get(t),k(t),w.has(t)&&(w.delete(t),n.forEach(r=>r.unsubscribe(t)),_.delete(t)))},q=new WeakMap,p=(t,...e)=>{e=e.filter(Boolean),q.set(t,u.__currentObject__),_.set(t,new Set(e));try{y(()=>e.forEach(n=>n.subscribe(t))),N(t)}catch(n){console.trace(e),console.error(n)}return()=>{w.delete(t),y(()=>e.forEach(n=>n.unsubscribe(t))),_.delete(t)}};p.once=(t,...e)=>(w.add(t),p(t,...e));p.wrap=(t,...e)=>p(y(t),...e);var ut=(t,e)=>{let n=(...s)=>{let r;return k(()=>{r=t(...s)}),r};return e&&f(e,n),n},pt=t=>{let e,n,s,r=async()=>{if(n&&await s,n=e,e=null,n)try{s=n.fn(...n.args),await s}catch(i){console.error(i)}finally{n=null}if(e)return r()};return(...i)=>{let o=e;return e={fn:t,args:i},o?s:r()}};var tt=["class","extends","slot","attrs","props","pins","component"];var et=t=>t.split("-").map(e=>e[0].toLocaleUpperCase()+e.slice(1)).join(""),D=(t,e,n)=>{for(let[s,r]of Object.entries(e))n(s,r)&&(t[s]=r);return t},L=(t,e)=>typeof e===t;var F=t=>tt.includes(t),nt=t=>D({},t,(e,n)=>!L("function",n)&&!F(e)),H=t=>D({},t,(e,n)=>L("function",n)&&!F(e)),st=(t,e)=>{for(let[n,s]of Object.entries(e))Array.isArray(s)?t[n]=s.slice():typeof s=="object"?t[n]=Object.create(s):t[n]=s},S=(t={},e={})=>{for(let[n,s]of Object.entries(e))Array.isArray(s)?t[n]=s.slice():typeof s=="object"?t[n]=S(t[n]||{},s):t[n]=s;return t},C=(t,e={},n={})=>{for(let s in e){let r=t[s];Object.defineProperty(t,s,{get(){return n.get?.call(this,s)??Reflect.get(e,s)},set(i){return n.set?.call(this,s,i),Reflect.set(e,s,i)}}),r!=null&&(t[s]=r)}},W=class extends HTMLElement{constructor({attrs:e={},props:n={},pins:s={}}={}){super();let r=this,i=this.constructor,o=S({attrs:e,props:n,pins:s},{props:{slotted:Array,html:String}});this.params=o,this.state??={attrs:b(o.attrs),props:b(o.props),pins:b(Object.fromEntries(Object.keys(o.pins??{}).map(a=>[a,Object])))},C(this,this.state.props),C(this,this.state.attrs,{set(a,c){if(this.getAttribute(a)!=c){this.setAttribute(a,c);return}}}),C(this,this.state.pins),i.slot&&this.createSlot(),p(()=>{y(()=>{this.root.innerHTML=this.html;for(let[c,l]of Object.entries(o.pins??{}))r[c]=this.get(l);let a=this.root.querySelector("slot");a&&this.useSlot(a)})},this.html)}get root(){return this.shadowRoot||this.attachShadow({mode:"open"}),this.shadowRoot}render(e,...n){y(()=>{R(this.root,M(this)(e,...n),this),y(()=>{for(let[r,i]of Object.entries(this.params.pins??{}))this[r]=this.get(i)});let s=this.root.querySelector("slot");s&&this.useSlot(s)})}useSlot(e){let n=()=>e.assignedElements({flatten:!0}).slice();e.parentNode!==this.root&&this.root.appendChild(e);let s=()=>{let r=n();r.length&&(this.slotted=r)};s(),e.addEventListener("slotchange",s)}createSlot(){let e=document.createElement("slot");this.useSlot(e)}get(e){return this?.shadowRoot?.querySelector?.(e)}getSlot(e){return this?.shadowRoot?.querySelector?.("slot")?.querySelector(e)}getAll(e){return this?.shadowRoot?.querySelectorAll?.(e)}getAllSlot(e){return this?.shadowRoot?.querySelector?.("slot")?.querySelectorAll(e)}dispatch(e,n){this.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,detail:n}))}attributeChangedCallback(e,n,s){y(()=>{this[e]=s})}},bt=t=>{let{component:e=()=>{},attrs:n={},props:s={},pins:r={}}=t,i=t.extends??W,o=et(t.class),a={[o]:class extends i{constructor(c){super(S(c,{attrs:n,props:s,pins:r}));u.__currentObject__=this,A(this,H(t)),st(this,nt(t)),e?.call(this)}}};return Object.assign(a[o],{slot:i.slot||t.slot,desc:t}),Object.assign(a[o].prototype,H(t)),Object.defineProperty(a[o],"observedAttributes",{get(){return Object.keys(t.attrs??[]).concat((i??{}).observedAttributes||[])}}),a[o]};export{m as Types,j as UID,pt as atomic,M as bind,ut as callback,bt as create,p as effect,at as el,S as mergeParams,f as patchMethod,A as patchMethods,lt as quiet,b as state,u as top,k as unwrap,y as wrap};
//# sourceMappingURL=index.js.map
